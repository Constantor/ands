<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>ands.algorithms.graphs.dijkstra API documentation</title>
    <meta name="description" content="Author: Nelson Brochado
Creation: July, 2015

Implementation of a typical Dijkstra's single-source s..." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>


  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#ands.algorithms.graphs.dijkstra.BLACK">BLACK</a></li>
    <li class="mono"><a href="#ands.algorithms.graphs.dijkstra.GREY">GREY</a></li>
    <li class="mono"><a href="#ands.algorithms.graphs.dijkstra.INFINITY">INFINITY</a></li>
    <li class="mono"><a href="#ands.algorithms.graphs.dijkstra.NIL">NIL</a></li>
    <li class="mono"><a href="#ands.algorithms.graphs.dijkstra.WHITE">WHITE</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#ands.algorithms.graphs.dijkstra.dijkstra">dijkstra</a></li>
    <li class="mono"><a href="#ands.algorithms.graphs.dijkstra.test_dijkstra">test_dijkstra</a></li>
    <li class="mono"><a href="#ands.algorithms.graphs.dijkstra.test_dijkstra2">test_dijkstra2</a></li>
  </ul>

    </li>


    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">ands.algorithms.graphs.dijkstra</span> module</h1>
  <p>Author: Nelson Brochado
Creation: July, 2015</p>
<p>Implementation of a typical Dijkstra's single-source shortest path algorithm.
It uses the min priority queue implementation found in MinPriorityQueue.py.</p>
<p>Want to know more about Dijkstra's single-source shortest path algorithm?
- http://interactivepython.org/courselib/static/pythonds/Graphs/DijkstrasAlgorithm.html
- https://www.youtube.com/watch?v=elUoBUwIlpQ (Computer Networks 5-3: Dijkstra's Algorithm)</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ands.algorithms.graphs.dijkstra', this);">Show source &equiv;</a></p>
  <div id="source-ands.algorithms.graphs.dijkstra" class="source">
    <pre><code>#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
Author: Nelson Brochado
Creation: July, 2015

Implementation of a typical Dijkstra's single-source shortest path algorithm.
It uses the min priority queue implementation found in MinPriorityQueue.py.

Want to know more about Dijkstra's single-source shortest path algorithm?
- http://interactivepython.org/courselib/static/pythonds/Graphs/DijkstrasAlgorithm.html
- https://www.youtube.com/watch?v=elUoBUwIlpQ (Computer Networks 5-3: Dijkstra's Algorithm)
"""

from ands.ds.Graph import *
from ands.ds.MinPriorityQueue import *


def _initialise_single_source(graph, source_node):
    """Initialisation step for Dijkstra's
    single source shortest path algorithm.

    :type graph : Graph
    :type source_node : GraphNode
    """
    for u in graph.nodes:
        u.distance = INFINITY
        u.predecessor = NIL

    source_node.distance = 0


def _relax(u: GraphNode, v: GraphNode, w: "function", q: MinPriorityQueue):
    """Relaxes the distance to v from u, using the weight function w.

    u is the current node.

    v is the adjacent node to u that we want to _relax.

    w is the weight function.

    q is the MinPriorityQueue object containing v,
    that we need to change v's priority within it,
    if eventually we _relax v's distance to the source node."""
    if v.distance > u.distance + w(u, v):
        v.distance = u.distance + w(u, v)
        v.predecessor = u

        # Raises an error if v is no more in q
        # This is nice because this only happens
        # where there's a negative weighted edge.
        q.change_priority(v, u.distance + w(u, v))


def _nodes_and_distances(g: Graph):
    ls = []
    for node in g.nodes:
        ls.append((node, node.distance))
    return ls


def dijkstra(g: Graph, s: GraphNode):
    """
    Dijkstra's algorithm to calculate since-source shortest paths,
    that is, to calculate the shortest path between a source node and
    any other node in graph, which should be a directed weighted graph.

    This algorithm maintains tha invariant  Q = V - S,
    where Q is the min priority queue (set),
    V is the set of vertices in the graph,
    and S is the set of visited nodes,
    whose distances have already been determined.

    Note that the algorithm never inserts nodes in q (Q),
    after it is initialised with the nodes of the graph,
    but priorities are changed only.

    Note also that each vertex that is extracted from Q,
    is added to the set of visited nodes S exactly once.

    Since this algorithm always chooses the lightest edge from Q to add to S,
    we say that this algorithm uses a greedy strategy.

    Greedy strategies not always yield an optimal solution,
    but in the case of this algorithm, it does.

    This algorithm does not work when edges have negative weights.
    Lets look at an example that illustrates this.

    Suppose we have a graph of 3 nodes like the following:

    Adjacency lists:

    S = [(A, 3), (B, 2)]
    A = [(S, 3), (B, -2)]
    B = [(S, 2), (A, -2)]

    Edges = [(S, A, 3), (S, B, 2), (A, B, -2)]

    Note that the previous graph is an undirected graph,
    where basically, if A and B are connected,
    then A contains a tuple representing its connection to B,
    and vice-versa, B contains a tuple representing its connection to A.
    In the set of edges, we can see more clearly these undirected edges.

    Now, suppose we start this algorithm from S.
    The first thing to do is to update the current shortest path to A and B.
    We set A.distance = 3 and B.distance = 2.
    Then we visit B. We update A's distance to 0.

    Why doesn't this algorithm work on this graph?

    If you start from S and then go to A and finally to B,
    we obtain a shortest path of length 1,
    but note that this algorithm gave us a shortest path to B of 2,
    which is incorrect!"""

    _initialise_single_source(g, s)

    # This set will contain the vertices of graph,
    # whose shortest path weights from s have already been determined.
    visited_nodes = set()

    # Creation of a MinPriorityQueue object that takes into account as priorities
    # the distances of the nodes in the graph from source node s.
    # _nodes_and_distances returns a list of tuples.
    # The first item of each of these tuples
    # is a HeapNode and the second its distance from s,
    # At this point, all distances have been already set to INFINITY
    # by _initialise_single_source,
    # except for the source node s, whose distance has been set to 0.
    q = MinPriorityQueue(_nodes_and_distances(g))

    while q.is_not_empty():
        # u has the estimated shortest path in the set V - S
        # Note that the first element being pulled is s.
        u = q.extract_min()

        # {u} is a set with one element
        # The following operation (in this case)
        # is equivalent to: visited_nodes.add(u)
        visited_nodes = visited_nodes.union({u})

        for v in u.get_adjacent_nodes():
            # In the implementation of the graph data structure in Graph.py,
            # the weight of an edge between two connected nodes
            # can be found by calling the static method weight,
            # by passing to it the two nodes of the edge.

            _relax(u, v, g.weight, q)

    return visited_nodes


def test_dijkstra():
    g = Graph()

    s = GraphNode("S")
    t = GraphNode("T")
    y = GraphNode("Y")
    x = GraphNode("X")
    z = GraphNode("Z")

    s.add_adjacent_node(t, weight=10)
    s.add_adjacent_node(y, weight=5)

    y.add_adjacent_node(t, weight=3)
    y.add_adjacent_node(z, weight=2)
    y.add_adjacent_node(x, weight=9)

    t.add_adjacent_node(y, weight=2)
    t.add_adjacent_node(x, weight=1)

    x.add_adjacent_node(z, weight=4)

    z.add_adjacent_node(x, weight=6)
    z.add_adjacent_node(s, weight=7)

    g.add_nodes((s, t, y, x, z))

    visited_updated_nodes = dijkstra(g, s)

    print(visited_updated_nodes)

    for n in visited_updated_nodes:
        print("Node:", n, ",Distance:", n.distance)


def test_dijkstra2():
    g = Graph()

    s = GraphNode("s")
    a = GraphNode("a")
    b = GraphNode("b")

    g.add_undirected_edge(s, a, 3)
    g.add_undirected_edge(a, b, 1)
    g.add_undirected_edge(s, b, 2)

    dijkstra(g, s)

    g.show_nodes()

#if __name__ == "__main__":
    # test_dijkstra()
test_dijkstra2()
</code></pre>
  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="ands.algorithms.graphs.dijkstra.BLACK" class="name">var <span class="ident">BLACK</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="ands.algorithms.graphs.dijkstra.GREY" class="name">var <span class="ident">GREY</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="ands.algorithms.graphs.dijkstra.INFINITY" class="name">var <span class="ident">INFINITY</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="ands.algorithms.graphs.dijkstra.NIL" class="name">var <span class="ident">NIL</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="ands.algorithms.graphs.dijkstra.WHITE" class="name">var <span class="ident">WHITE</span></p>
      
  
  <div class="source_cont">
</div>

      </div>

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="ands.algorithms.graphs.dijkstra.dijkstra">
    <p>def <span class="ident">dijkstra</span>(</p><p>g, s)</p>
    </div>
    

    
  
    <div class="desc"><p>Dijkstra's algorithm to calculate since-source shortest paths,
that is, to calculate the shortest path between a source node and
any other node in graph, which should be a directed weighted graph.</p>
<p>This algorithm maintains tha invariant  Q = V - S,
where Q is the min priority queue (set),
V is the set of vertices in the graph,
and S is the set of visited nodes,
whose distances have already been determined.</p>
<p>Note that the algorithm never inserts nodes in q (Q),
after it is initialised with the nodes of the graph,
but priorities are changed only.</p>
<p>Note also that each vertex that is extracted from Q,
is added to the set of visited nodes S exactly once.</p>
<p>Since this algorithm always chooses the lightest edge from Q to add to S,
we say that this algorithm uses a greedy strategy.</p>
<p>Greedy strategies not always yield an optimal solution,
but in the case of this algorithm, it does.</p>
<p>This algorithm does not work when edges have negative weights.
Lets look at an example that illustrates this.</p>
<p>Suppose we have a graph of 3 nodes like the following:</p>
<p>Adjacency lists:</p>
<p>S = [(A, 3), (B, 2)]
A = [(S, 3), (B, -2)]
B = [(S, 2), (A, -2)]</p>
<p>Edges = [(S, A, 3), (S, B, 2), (A, B, -2)]</p>
<p>Note that the previous graph is an undirected graph,
where basically, if A and B are connected,
then A contains a tuple representing its connection to B,
and vice-versa, B contains a tuple representing its connection to A.
In the set of edges, we can see more clearly these undirected edges.</p>
<p>Now, suppose we start this algorithm from S.
The first thing to do is to update the current shortest path to A and B.
We set A.distance = 3 and B.distance = 2.
Then we visit B. We update A's distance to 0.</p>
<p>Why doesn't this algorithm work on this graph?</p>
<p>If you start from S and then go to A and finally to B,
we obtain a shortest path of length 1,
but note that this algorithm gave us a shortest path to B of 2,
which is incorrect!</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ands.algorithms.graphs.dijkstra.dijkstra', this);">Show source &equiv;</a></p>
  <div id="source-ands.algorithms.graphs.dijkstra.dijkstra" class="source">
    <pre><code>def dijkstra(g: Graph, s: GraphNode):
    """
    Dijkstra's algorithm to calculate since-source shortest paths,
    that is, to calculate the shortest path between a source node and
    any other node in graph, which should be a directed weighted graph.

    This algorithm maintains tha invariant  Q = V - S,
    where Q is the min priority queue (set),
    V is the set of vertices in the graph,
    and S is the set of visited nodes,
    whose distances have already been determined.

    Note that the algorithm never inserts nodes in q (Q),
    after it is initialised with the nodes of the graph,
    but priorities are changed only.

    Note also that each vertex that is extracted from Q,
    is added to the set of visited nodes S exactly once.

    Since this algorithm always chooses the lightest edge from Q to add to S,
    we say that this algorithm uses a greedy strategy.

    Greedy strategies not always yield an optimal solution,
    but in the case of this algorithm, it does.

    This algorithm does not work when edges have negative weights.
    Lets look at an example that illustrates this.

    Suppose we have a graph of 3 nodes like the following:

    Adjacency lists:

    S = [(A, 3), (B, 2)]
    A = [(S, 3), (B, -2)]
    B = [(S, 2), (A, -2)]

    Edges = [(S, A, 3), (S, B, 2), (A, B, -2)]

    Note that the previous graph is an undirected graph,
    where basically, if A and B are connected,
    then A contains a tuple representing its connection to B,
    and vice-versa, B contains a tuple representing its connection to A.
    In the set of edges, we can see more clearly these undirected edges.

    Now, suppose we start this algorithm from S.
    The first thing to do is to update the current shortest path to A and B.
    We set A.distance = 3 and B.distance = 2.
    Then we visit B. We update A's distance to 0.

    Why doesn't this algorithm work on this graph?

    If you start from S and then go to A and finally to B,
    we obtain a shortest path of length 1,
    but note that this algorithm gave us a shortest path to B of 2,
    which is incorrect!"""

    _initialise_single_source(g, s)

    # This set will contain the vertices of graph,
    # whose shortest path weights from s have already been determined.
    visited_nodes = set()

    # Creation of a MinPriorityQueue object that takes into account as priorities
    # the distances of the nodes in the graph from source node s.
    # _nodes_and_distances returns a list of tuples.
    # The first item of each of these tuples
    # is a HeapNode and the second its distance from s,
    # At this point, all distances have been already set to INFINITY
    # by _initialise_single_source,
    # except for the source node s, whose distance has been set to 0.
    q = MinPriorityQueue(_nodes_and_distances(g))

    while q.is_not_empty():
        # u has the estimated shortest path in the set V - S
        # Note that the first element being pulled is s.
        u = q.extract_min()

        # {u} is a set with one element
        # The following operation (in this case)
        # is equivalent to: visited_nodes.add(u)
        visited_nodes = visited_nodes.union({u})

        for v in u.get_adjacent_nodes():
            # In the implementation of the graph data structure in Graph.py,
            # the weight of an edge between two connected nodes
            # can be found by calling the static method weight,
            # by passing to it the two nodes of the edge.

            _relax(u, v, g.weight, q)

    return visited_nodes
</code></pre>
  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="ands.algorithms.graphs.dijkstra.test_dijkstra">
    <p>def <span class="ident">test_dijkstra</span>(</p><p>)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ands.algorithms.graphs.dijkstra.test_dijkstra', this);">Show source &equiv;</a></p>
  <div id="source-ands.algorithms.graphs.dijkstra.test_dijkstra" class="source">
    <pre><code>def test_dijkstra():
    g = Graph()

    s = GraphNode("S")
    t = GraphNode("T")
    y = GraphNode("Y")
    x = GraphNode("X")
    z = GraphNode("Z")

    s.add_adjacent_node(t, weight=10)
    s.add_adjacent_node(y, weight=5)

    y.add_adjacent_node(t, weight=3)
    y.add_adjacent_node(z, weight=2)
    y.add_adjacent_node(x, weight=9)

    t.add_adjacent_node(y, weight=2)
    t.add_adjacent_node(x, weight=1)

    x.add_adjacent_node(z, weight=4)

    z.add_adjacent_node(x, weight=6)
    z.add_adjacent_node(s, weight=7)

    g.add_nodes((s, t, y, x, z))

    visited_updated_nodes = dijkstra(g, s)

    print(visited_updated_nodes)

    for n in visited_updated_nodes:
        print("Node:", n, ",Distance:", n.distance)
</code></pre>
  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="ands.algorithms.graphs.dijkstra.test_dijkstra2">
    <p>def <span class="ident">test_dijkstra2</span>(</p><p>)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ands.algorithms.graphs.dijkstra.test_dijkstra2', this);">Show source &equiv;</a></p>
  <div id="source-ands.algorithms.graphs.dijkstra.test_dijkstra2" class="source">
    <pre><code>def test_dijkstra2():
    g = Graph()

    s = GraphNode("s")
    a = GraphNode("a")
    b = GraphNode("b")

    g.add_undirected_edge(s, a, 3)
    g.add_undirected_edge(a, b, 1)
    g.add_undirected_edge(s, b, 2)

    dijkstra(g, s)

    g.show_nodes()
</code></pre>
  </div>
</div>

  </div>
  


  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.1</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
